#include "bsp_spi_sw.h"
#include "bsp_spi_oled.h"
#include "stdlib.h"
#include "string.h" 

/*
从FLASH中读取中文字模
OLED显示
*/

extern void delay_us(uint32_t i);
extern void delay_ms(uint32_t i);


//数组每个bit存储OLED每个像素点的颜色值(1-亮(白色),0-灭(黑色))
//每个数组元素表示1列8个像素点，一共128列
static unsigned char OLED_buffer[1024] = 
{
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};

const uint8_t ASCII8x16_Table [ ] = {       //@conslons字体，阴码点阵格式，逐行顺向取摸
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x18,0x18,0x18,0x18,0x18,0x18,0x08,0x00,0x08,0x18,0x00,0x00,0x00,
0x00,0x00,0x00,0x34,0x24,0x24,0x24,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x16,0x24,0x7f,0x24,0x24,0x24,0x7e,0x24,0x24,0x00,0x00,0x00,
0x00,0x00,0x00,0x08,0x3e,0x68,0x48,0x68,0x1c,0x16,0x12,0x12,0x7c,0x10,0x10,0x00,
0x00,0x00,0x00,0x61,0xd2,0x96,0x74,0x08,0x10,0x16,0x29,0x49,0xc6,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x3c,0x64,0x64,0x38,0x72,0x4a,0xce,0x46,0x7f,0x00,0x00,0x00,
0x00,0x00,0x00,0x18,0x18,0x18,0x18,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x04,0x08,0x18,0x10,0x30,0x30,0x30,0x30,0x10,0x10,0x18,0x0c,0x04,
0x00,0x00,0x00,0x20,0x10,0x08,0x08,0x0c,0x04,0x04,0x04,0x0c,0x08,0x18,0x10,0x20,
0x00,0x00,0x00,0x08,0x0a,0x34,0x1c,0x6a,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x18,0x7f,0x18,0x18,0x18,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x08,0x30,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3c,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x00,0x00,0x00,
0x00,0x00,0x00,0x02,0x06,0x04,0x0c,0x08,0x08,0x10,0x10,0x20,0x20,0x40,0x00,0x00,
0x00,0x00,0x00,0x00,0x3c,0x66,0x42,0x47,0x5b,0x73,0x42,0x66,0x3c,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x18,0x78,0x48,0x08,0x08,0x08,0x08,0x08,0x7e,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x3c,0x46,0x06,0x06,0x04,0x08,0x10,0x20,0x7e,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x7c,0x06,0x06,0x04,0x3c,0x02,0x02,0x06,0x7c,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x0c,0x1c,0x14,0x24,0x64,0x44,0xff,0x04,0x04,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x7e,0x60,0x60,0x60,0x7e,0x02,0x02,0x06,0x7c,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x1e,0x30,0x60,0x48,0x76,0x42,0x42,0x62,0x3c,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x7e,0x02,0x06,0x04,0x0c,0x08,0x18,0x10,0x30,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x3c,0x62,0x42,0x36,0x1c,0x66,0x42,0x42,0x3c,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x3c,0x66,0x42,0x42,0x66,0x1a,0x02,0x04,0x78,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x00,0x00,0x00,0x18,0x18,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x00,0x00,0x00,0x18,0x18,0x08,0x30,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x18,0x30,0x60,0x10,0x0c,0x06,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7e,0x00,0x7e,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x18,0x04,0x06,0x0c,0x10,0x20,0x00,0x00,0x00,
0x00,0x00,0x00,0x30,0x1c,0x06,0x06,0x06,0x18,0x10,0x00,0x10,0x10,0x00,0x00,0x00,
0x00,0x00,0x00,0x1c,0x22,0x41,0x41,0xdd,0xb5,0xa5,0xa5,0xaf,0x94,0xc0,0x40,0x3c,
0x00,0x00,0x00,0x00,0x18,0x1c,0x34,0x24,0x26,0x62,0x7e,0x43,0xc1,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x7c,0x46,0x42,0x46,0x7c,0x42,0x42,0x42,0x7c,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x1e,0x20,0x40,0x40,0x40,0x40,0x40,0x60,0x3e,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x7c,0x46,0x42,0x43,0x43,0x43,0x42,0x46,0x78,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x7e,0x60,0x60,0x60,0x7e,0x60,0x60,0x60,0x7e,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x7e,0x60,0x60,0x60,0x7e,0x60,0x60,0x60,0x60,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x1e,0x60,0x40,0x40,0xce,0x42,0x42,0x62,0x3e,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x42,0x42,0x42,0x42,0x7e,0x42,0x42,0x42,0x42,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x7e,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x7e,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x7c,0x04,0x04,0x04,0x04,0x04,0x04,0x44,0x78,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x42,0x44,0x48,0x50,0x70,0x58,0x4c,0x44,0x42,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x3e,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x62,0x66,0x67,0x5f,0x5b,0x5b,0xc1,0xc1,0xc1,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x62,0x62,0x72,0x52,0x5a,0x4a,0x4e,0x46,0x46,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x3c,0x62,0x43,0xc3,0xc3,0xc3,0x43,0x62,0x3c,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x7c,0x46,0x42,0x42,0x46,0x78,0x40,0x40,0x40,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x3c,0x62,0x43,0xc3,0xc3,0xc3,0x43,0x62,0x3c,0x18,0x0f,0x00,
0x00,0x00,0x00,0x00,0x7c,0x66,0x62,0x66,0x7c,0x6c,0x64,0x66,0x62,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x3e,0x60,0x40,0x60,0x1c,0x06,0x02,0x02,0x7c,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x7f,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x62,0x3c,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xc1,0x43,0x42,0x62,0x26,0x24,0x34,0x1c,0x18,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xc1,0xc1,0x41,0x49,0x5b,0x5b,0x76,0x66,0x66,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x43,0x66,0x34,0x18,0x18,0x1c,0x24,0x66,0xc3,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xc1,0x42,0x66,0x34,0x1c,0x18,0x18,0x18,0x18,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x7e,0x02,0x04,0x0c,0x18,0x10,0x20,0x60,0x7e,0x00,0x00,0x00,
0x00,0x00,0x00,0x1c,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x1c,
0x00,0x00,0x00,0x40,0x20,0x20,0x10,0x10,0x08,0x08,0x0c,0x04,0x06,0x02,0x00,0x00,
0x00,0x00,0x00,0x3c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x3c,
0x00,0x00,0x00,0x00,0x18,0x1c,0x24,0x62,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff,
0x00,0x00,0x00,0x20,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x3c,0x06,0x02,0x3e,0x42,0x46,0x7a,0x00,0x00,0x00,
0x00,0x00,0x00,0x40,0x40,0x40,0x5c,0x62,0x42,0x42,0x42,0x42,0x7c,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x1e,0x20,0x60,0x40,0x60,0x20,0x3e,0x00,0x00,0x00,
0x00,0x00,0x00,0x02,0x02,0x02,0x3e,0x62,0x42,0x42,0x42,0x66,0x3a,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x3c,0x62,0x42,0x7e,0x40,0x60,0x3e,0x00,0x00,0x00,
0x00,0x00,0x00,0x0f,0x18,0x10,0x10,0x7e,0x10,0x10,0x10,0x10,0x10,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x3f,0x66,0x42,0x66,0x58,0x40,0x3e,0x43,0x42,0x3c,
0x00,0x00,0x00,0x40,0x40,0x40,0x5c,0x62,0x42,0x42,0x42,0x42,0x42,0x00,0x00,0x00,
0x00,0x00,0x00,0x18,0x18,0x00,0x78,0x08,0x08,0x08,0x08,0x08,0x7e,0x00,0x00,0x00,
0x00,0x00,0x00,0x04,0x0c,0x00,0x7c,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x0c,0x78,
0x00,0x00,0x00,0x60,0x60,0x60,0x62,0x6c,0x78,0x70,0x68,0x64,0x62,0x00,0x00,0x00,
0x00,0x00,0x00,0x78,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x7e,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x76,0x4b,0x4b,0x4b,0x4b,0x4b,0x4b,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x5c,0x62,0x42,0x42,0x42,0x42,0x42,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x3c,0x62,0x42,0x43,0x42,0x62,0x3c,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x5c,0x62,0x42,0x42,0x42,0x42,0x7c,0x40,0x40,0x40,
0x00,0x00,0x00,0x00,0x00,0x00,0x3e,0x62,0x42,0x42,0x42,0x66,0x3a,0x02,0x02,0x02,
0x00,0x00,0x00,0x00,0x00,0x00,0x6e,0x72,0x63,0x60,0x60,0x60,0x60,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x3e,0x20,0x20,0x3c,0x06,0x02,0x7c,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x10,0x10,0xfe,0x10,0x10,0x10,0x10,0x10,0x1e,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x42,0x42,0x42,0x42,0x42,0x66,0x3a,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x43,0x42,0x66,0x24,0x34,0x18,0x18,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0xc1,0xc1,0x5b,0x5a,0x5e,0x66,0x66,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x62,0x26,0x1c,0x18,0x1c,0x26,0x62,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x43,0x42,0x66,0x24,0x34,0x1c,0x18,0x18,0x30,0xe0,
0x00,0x00,0x00,0x00,0x00,0x00,0x7e,0x06,0x0c,0x18,0x10,0x20,0x7e,0x00,0x00,0x00,
0x00,0x00,0x00,0x0e,0x18,0x10,0x10,0x10,0x30,0x70,0x10,0x10,0x10,0x10,0x18,0x0e,
0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
0x00,0x00,0x00,0x30,0x18,0x08,0x08,0x08,0x0c,0x0e,0x08,0x08,0x08,0x08,0x18,0x30,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x71,0x4b,0x06,0x00,0x00,0x00,0x00,0x00,
};  

/*
*函数说明：	初始化OLED的功能管脚
*输入形参：	无
*输出数据：	无
*/
static void SPI_OLED_GPIO_Config(void)
{
	SPI_OLED_RES_CLK;
	SPI_OLED_DC_CLK;
	SPI_OLED_CS_CLK;

	GPIO_InitTypeDef GPIO_InitStructure;
	
	GPIO_InitStructure.Speed = GPIO_SPEED_FREQ_HIGH;
	GPIO_InitStructure.Pull  = GPIO_NOPULL;
	GPIO_InitStructure.Mode  = GPIO_MODE_OUTPUT_PP;
	GPIO_InitStructure.Pin   = SPI_OLED_RES_PIN;
	HAL_GPIO_Init(SPI_OLED_RES_PORT, &GPIO_InitStructure);
	
	GPIO_InitStructure.Pin = SPI_OLED_DC_PIN;
	HAL_GPIO_Init(SPI_OLED_DC_PORT, &GPIO_InitStructure);
	
	GPIO_InitStructure.Pin = SPI_OLED_CS_PIN;
	HAL_GPIO_Init(SPI_OLED_CS_PORT, &GPIO_InitStructure);
	
	SPI_OLED_CS_HIGH();
	SPI_OLED_RES_HIGH();
}

/*
*函数说明：	向OLED发送数据
*输入形参：	一个8位数据
*输出数据：	无
*/
void bsp_OLED_Send_DATA(uint8_t data)
{
	SPI_OLED_DC_HIGH();
	SPI_OLED_CS_LOW();
	
	bsp_SPI_SW_Write_Byte(data);

	SPI_OLED_CS_HIGH();
}

/*
*函数说明：	向OLED发送命令
*输入形参：	一个8位命令
*输出数据：	无
*/
void bsp_OLED_Send_Cmd(uint8_t data)
{
	SPI_OLED_DC_LOW();
	SPI_OLED_CS_LOW();
	
	bsp_SPI_SW_Write_Byte(data);

	SPI_OLED_CS_HIGH();
}

/*
*函数说明：	向OLED发送复位
*输入形参：	无
*输出数据：	无
*/
void bsp_OLED_RESET(void)
{
	SPI_OLED_RES_HIGH();
 	delay_ms(1);
	SPI_OLED_RES_LOW();
 	delay_ms(1);
	SPI_OLED_RES_HIGH();
}

/*
*函数说明：	开启OLED的显示
*输入形参： 无
*输出数据：	无
*/
void bsp_OLED_Display_On(void)
{
	bsp_OLED_Send_Cmd(SPI_OLED_CHARGE_PUMP);  	//SET DCDC命令
	bsp_OLED_Send_Cmd(SPI_OLED_PUMP_ON);  		//DCDC ON
	bsp_OLED_Send_Cmd(SPI_OLED_ON);  			//DISPLAY ON
}

/*
*函数说明：	关闭OLED的显示
*输入形参：	无
*输出数据：	无
*/
void bsp_OLED_Display_Off(void)
{
	bsp_OLED_Send_Cmd(SPI_OLED_CHARGE_PUMP);  	//SET DCDC命令
	bsp_OLED_Send_Cmd(SPI_OLED_PUMP_OFF);  		//DCDC OFF
	bsp_OLED_Send_Cmd(SPI_OLED_OFF);  			//DISPLAY OFF
}

/*
*函数说明：	设置OLED对比度
*输入形参：	对比度（0-127）
*输出数据：	无
*/
void bsp_OLED_SetContrast(uint8_t ContrastData)
{
	bsp_OLED_Send_Cmd(SPI_OLDE_CONTRAST);
	bsp_OLED_Send_Cmd(ContrastData);
}

/*
*函数说明：	设置OLED屏幕坐标
*输入形参：	x：x轴坐标（0-127）
*			y：y轴坐标（0-63）
*输出数据：	无
*/
void bsp_OLED_Set_Pos(uint8_t x, uint8_t y) 
{
 	bsp_OLED_Send_Cmd(YLevel+y/PAGE_SIZE);			/* y轴坐标 */
	bsp_OLED_Send_Cmd((((x+2)&0xf0)>>4)|0x10);		/* x轴高4位 */
	bsp_OLED_Send_Cmd(((x+2)&0x0f)); 				/* x轴低4位 */
}  

/*
*函数说明：	将像素值设置到RAM
*输入形参：	x：x轴坐标（0-127）
*			y：y轴坐标（0-63页）
*			color：1：（正常显示），0：（对比显示）
*输出数据：	无
*/
void bsp_OLED_Set_Pixel(uint8_t x, uint8_t y,uint8_t color)
{
	if(color)
	{
		OLED_buffer[(y/PAGE_SIZE)*WIDTH+x]|= (1<<(y%PAGE_SIZE))&0xff;
	}
	else
	{
		OLED_buffer[(y/PAGE_SIZE)*WIDTH+x]&= ~((1<<(y%PAGE_SIZE))&0xff);
	}
}		   			 

/*
*函数说明：	OLED屏幕更新显示
*输入形参：	无
*输出数据：	无
*/
void bsp_OLED_UP_Display(void)
{
	uint8_t i,n;		    
	for(i=0;i<PAGE_SIZE;i++)  
	{  
		bsp_OLED_Send_Cmd(YLevel+i);    	//设置页地址（0~7）
		bsp_OLED_Send_Cmd(XLevelL);      	//设置显示位置―列低地址
		bsp_OLED_Send_Cmd(XLevelH);      	//设置显示位置―列高地址   
		for(n=0;n<WIDTH;n++)
		{
			bsp_OLED_Send_DATA(OLED_buffer[i*WIDTH+n]); 
		}
	}   //更新显示
}

/*
*函数说明：	清除的OLED屏幕
*输入形参：	dat：1：（清屏），0：（填充）
*输出数据：	无
*/
void bsp_OLED_Clear(uint8_t dat)  
{  
	if(dat)
	{
		memset(OLED_buffer,0xff,sizeof(OLED_buffer));
	}
	else
	{
		memset(OLED_buffer,0,sizeof(OLED_buffer));
	}
	bsp_OLED_UP_Display();
}

/*
*函数说明：	初始化OLED屏
*输入形参：	无
*输出数据：	无
*/
void bsp_OLED_Init(void)
{
	SPI_OLED_GPIO_Config();
	delay_ms(10);
	bsp_OLED_RESET();     //复位OLED
	delay_ms(10);
	bsp_OLED_Display_Off(); //power off
	
	bsp_OLED_Send_Cmd(0xAE);//--turn off oled panel
	bsp_OLED_Send_Cmd(0x02);//---set low column address
	bsp_OLED_Send_Cmd(0x10);//---set high column address
	bsp_OLED_Send_Cmd(0x40);//--set start line address  Set Mapping RAM Display Start Line (0x00~0x3F)
	bsp_OLED_Send_Cmd(0x81);//--set contrast control register
	bsp_OLED_Send_Cmd(0xCF); // Set SEG Output Current Brightness
	bsp_OLED_Send_Cmd(0xA1);//--Set SEG/Column Mapping     0xa0左右反置 0xa1正常
	bsp_OLED_Send_Cmd(0xC8);//Set COM/Row Scan Direction   0xc0上下反置 0xc8正常
	bsp_OLED_Send_Cmd(0xA6);//--set normal display
	bsp_OLED_Send_Cmd(0xA8);//--set multiplex ratio(1 to 64)
	bsp_OLED_Send_Cmd(0x3f);//--1/64 duty
	bsp_OLED_Send_Cmd(0xD3);//-set display offset	Shift Mapping RAM Counter (0x00~0x3F)
	bsp_OLED_Send_Cmd(0x00);//-not offset
	bsp_OLED_Send_Cmd(0xd5);//--set display clock divide ratio/oscillator frequency
	bsp_OLED_Send_Cmd(0x80);//--set divide ratio, Set Clock as 100 Frames/Sec
	bsp_OLED_Send_Cmd(0xD9);//--set pre-charge period
	bsp_OLED_Send_Cmd(0xF1);//Set Pre-Charge as 15 Clocks & Discharge as 1 Clock
	bsp_OLED_Send_Cmd(0xDA);//--set com pins hardware configuration
	bsp_OLED_Send_Cmd(0x12);
	bsp_OLED_Send_Cmd(0xDB);//--set vcomh
	bsp_OLED_Send_Cmd(0x40);//Set VCOM Deselect Level
	bsp_OLED_Send_Cmd(0x20);//-Set Page Addressing Mode (0x00/0x01/0x02)
	bsp_OLED_Send_Cmd(0x02);//
	bsp_OLED_Send_Cmd(0x8D);//--set Charge Pump enable/disable
	bsp_OLED_Send_Cmd(0x14);//--set(0x10) disable
	bsp_OLED_Send_Cmd(0xA4);// Disable Entire Display On (0xa4/0xa5)
	bsp_OLED_Send_Cmd(0xA6);// Disable Inverse Display On (0xa6/a7) 
	bsp_OLED_Send_Cmd(0xAF);//--turn on oled panel

  	bsp_OLED_Display_On(); // power on 
}  

// /*
//   * @brief  获取FLASH中文显示字库数据
// 	* @param  pBuffer:存储字库矩阵的缓冲区
// 	* @param  c ： 要获取的文字
//   * @retval None.
//   */
// void GetGBKCode_from_EXFlash(uint8_t * pBuffer, uint16_t c)
// { 
//     unsigned char High8bit,Low8bit;
//     unsigned int pos;
				
// 	  High8bit= c >> 8;     /* 取高8位数据 */
//     Low8bit= c & 0x00FF;  /* 取低8位数据 */		
	  	
// 		/*GB2312 公式*/
//     pos = ((High8bit-0xa1)*94+Low8bit-0xa1)*WIDTH_CH_CHAR*HEIGHT_CH_CHAR/8; 
// 		SPI_FLASH_BufferRead(pBuffer,GBKCODE_START_ADDRESS+pos,WIDTH_CH_CHAR*HEIGHT_CH_CHAR/8); //读取字库数据  
// }

// /*
//   * @brief  显示中文字符
// 	* @param  X ：X坐标
// 	* @param  Y ：Y坐标
// 	* @param  CH_ch ：要显示的中文字
//   * @retval None.
//   */
// void ILI9341_DispChar_CH(uint8_t X,uint8_t Y,uint16_t CH_ch)
// {
// 	uint8_t j,k;
// 	uint8_t ucBuffer[WIDTH_CH_CHAR*HEIGHT_CH_CHAR/8];	
// 	uint16_t usTemp;
	
// 	 GetGBKCode_from_EXFlash(ucBuffer, CH_ch);	
	
// 			for(j=0;j<16;j++)
// 			{
// 				usTemp = ucBuffer [ j * 2 ];
// 				usTemp = ( usTemp << 8 );
// 				usTemp |= ucBuffer [ j * 2 + 1 ];
				
// 					for(k=0;k<16;k++)
// 					{
// 						if(usTemp&(0x8000>>k))
// 						{
// 							bsp_OLED_Set_Pixel(X+k, Y+j,1);
// 						}
// 						else
// 						{
// 							bsp_OLED_Set_Pixel(X+k, Y+j,0);
// 						}
// 					}
// 			}	
// 	OLED_Display();
// }

/*
  * @brief  显示英文字符
	* @param  X ：X坐标
	* @param  Y ：Y坐标
	* @param  chr ：要显示的字母
  * @retval None.
  */
void ILI9341_DispChar_EN(uint8_t X,uint8_t Y,char EN_ch)
{      	
	uint8_t c=0,i=0,j=0;	
	uint8_t EN_chcode[WIDTH_EN_CHAR*HEIGHT_EN_CHAR/8];
	
	c=EN_ch-' ';//得到偏移后的值		
	
	for(i=0;i<16;i++)
	{
		EN_chcode[i] = ASCII8x16_Table[c*16+i];
		
		for(j=0;j<8;j++)
		{
			if(EN_chcode[i]&(0x80>>j))
			{
				bsp_OLED_Set_Pixel(X+j, Y+i,1);
			}
			else
			{
				bsp_OLED_Set_Pixel(X+j, Y+i,0);
			}
		}
	}
}



/*
  * @brief  OLED显示中英文字库数据
	* @param  X ： X坐标
	* @param  Y ： Y坐标
	* @param  ch ： 要显示的字
  * @retval None.
  */
void OLED_DispString_16X16_EN_CH(uint8_t X, uint8_t Y,char *ch)
{
	//uint16_t CH_ch;
	
	while(*ch != '\0' )
	{
		if(*ch <= 126 )//ASCII码
		{
			if(X+8 >= WIDTH)
			{
				Y+= 16;
				X = 0;
				if(Y >= HEIGHT)
					Y = 0;
			}
			ILI9341_DispChar_EN(X, Y, *ch);
			X += 8;
			ch += 1;

		}
		// else//中文
		// {
		// 	if(X+16 >= WIDTH)
		// 	{
		// 		Y+= 16;
		// 		X = 0;
		// 		if(Y >= HEIGHT)
		// 			Y = 0;			
		// 	}
		// 	CH_ch = *(uint16_t *)ch;
		// 	CH_ch = ( CH_ch << 8 ) + ( CH_ch >> 8 );//高8位与低8位互换
			
		// 	ILI9341_DispChar_CH( X, Y, CH_ch);

		// 	X += 16;
		// 	ch += 2;
		// }
	}
	bsp_OLED_UP_Display();
}
